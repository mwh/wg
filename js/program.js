import * as ast from "./ast.js";

function cons(head, tail) {
    return [head, ...tail];
}
function one(head) {
    return [head];
}
const nil = [];
const no = nil;

function objCons(body) {
    return new ast.ObjectConstructor(body);
}

function methDec(parts, returnType, annotations, body) {
    return new ast.MethodDecl(parts, returnType, annotations, body);
}

function part(name, params) {
    return new ast.Part(name, params);
}

function identifierDeclaration(name, type) {
    return new ast.IdentifierDeclaration(name, type);
}

function lexReq(parts) {
    return new ast.LexicalRequest(parts);
}

function dotReq(receiver, parts) {
    return new ast.ExplicitRequest(receiver, parts);
}

function defDec(name, type, annotations, value) {
    return new ast.DefDecl(name, type, annotations, value);
}

function varDec(name, type, annotations, value) {
    return new ast.VarDecl(name, type, annotations, value);
}

function numLit(value) {
    return new ast.NumberNode(value);
}

function strLit(value) {
    return new ast.StringNode(value);
}

function block(params, body) {
    return new ast.Block(params, body);
}

function comment(value) {
    return new ast.Comment(value);
}

function assn(lhs, rhs) {
    return new ast.Assign(lhs, rhs);
}

function returnStmt(value) {
    return new ast.ReturnStmt(value);
}

export function evaluate(code) {
    return eval(code)
}

const program = objCons(cons(methDec(one(part("EOFToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("EOF")))))))), cons(methDec(one(part("NumberToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("val", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), strLit("NUMBER")), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("("))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]")))))))))))))), cons(methDec(one(part("LParenToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("LPAREN")))))))), cons(methDec(one(part("RParenToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("RPAREN")))))))), cons(methDec(one(part("LBraceToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("LBRACE")))))))), cons(methDec(one(part("RBraceToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("RBRACE")))))))), cons(methDec(one(part("CommaToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("COMMA")))))))), cons(methDec(one(part("DotToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("DOT")))))))), cons(methDec(one(part("IdentifierToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("val", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), strLit("IDENTIFIER")), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("("))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]")))))))))))))), cons(methDec(one(part("KeywordToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("val", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), strLit("KEYWORD")), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("("))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")"))))), one(part("++", one(strLit("["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]")))))))))))))), cons(methDec(one(part("OperatorToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("val", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), strLit("OPERATOR")), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("("))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")"))))), one(part("++", one(strLit("["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]")))))))))))))), cons(methDec(one(part("StringToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("val", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), strLit("STRING")), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("("))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")"))))), one(part("++", one(strLit("["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]")))))))))))))), cons(methDec(one(part("EqualsToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("EQUALS")))))))), cons(methDec(one(part("AssignToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("ASSIGN")))))))), cons(methDec(one(part("ArrowToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("ARROW")))))))), cons(methDec(one(part("SymbolToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("nat", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), lexReq(one(part("nat", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]"))))))))))))), cons(methDec(one(part("NewlineToken", one(identifierDeclaration("index", nil)))), nil, nil, one(lexReq(one(part("SymbolToken", cons(lexReq(one(part("index", nil))), one(strLit("NEWLINE")))))))), cons(methDec(one(part("CommentToken", cons(identifierDeclaration("index", nil), one(identifierDeclaration("text", nil))))), nil, nil, one(objCons(cons(defDec("nature", nil, one("public"), strLit("COMMENT")), cons(defDec("position", nil, one("public"), lexReq(one(part("index", nil)))), cons(defDec("value", nil, one("public"), lexReq(one(part("text", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("nature", nil))), one(part("++", one(strLit("("))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")["))))), one(part("++", one(dotReq(lexReq(one(part("position", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("]")))))))))))))), cons(methDec(one(part("isOperatorCharacter", one(identifierDeclaration("c", nil)))), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("+"))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("-"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("*"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("/"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("="))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit(":"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("|"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("&"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("!"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit(">"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("<"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("."))))))))))), cons(methDec(one(part("isIdentifierStart", one(identifierDeclaration("c", nil)))), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("a"))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("b"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("c"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("d"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("e"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("f"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("g"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("h"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("i"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("j"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("k"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("l"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("m"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("n"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("o"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("p"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("q"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("r"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("s"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("t"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("u"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("v"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("w"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("x"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("y"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("z"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("A"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("B"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("C"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("D"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("E"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("F"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("G"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("H"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("I"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("J"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("K"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("L"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("M"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("N"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("O"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("P"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("Q"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("R"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("S"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("T"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("U"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("V"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("W"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("X"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("Y"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("Z"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("_"))))))))))), cons(methDec(one(part("isDigit", one(identifierDeclaration("c", nil)))), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("1"))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("2"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("3"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("4"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("5"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("6"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("7"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("8"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("9"))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("0"))))))))))), cons(methDec(one(part("lexer", one(identifierDeclaration("code", nil)))), nil, nil, one(objCons(cons(defDec("source", nil, nil, lexReq(one(part("code", nil)))), cons(varDec("index", nil, nil, one(numLit(1))), cons(varDec("line", nil, nil, one(numLit(1))), cons(varDec("column", nil, nil, one(numLit(0))), cons(varDec("lineStart", nil, nil, one(numLit(0))), cons(varDec("currentToken", nil, nil, one(lexReq(one(part("nextToken", nil))))), cons(methDec(one(part("nextToken", nil)), nil, nil, cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("index", nil))), one(part(">", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("EOFToken", one(lexReq(one(part("index", nil))))))))))))))), cons(varDec("c", nil, nil, one(dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil))))))))), cons(assn(lexReq(one(part("column", nil))), dotReq(lexReq(one(part("index", nil))), one(part("-", one(lexReq(one(part("lineStart", nil)))))))), cons(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))), cons(defDec("location", nil, nil, dotReq(dotReq(dotReq(lexReq(one(part("line", nil))), one(part("asString", nil))), one(part("++", one(strLit(":"))))), one(part("++", one(dotReq(lexReq(one(part("column", nil))), one(part("asString", nil)))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit(" "))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("nextToken", nil))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("("))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("LParenToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit(")"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("RParenToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("c", nil))), one(part(">", one(strLit("z"))))), one(part("&&", one(dotReq(lexReq(one(part("c", nil))), one(part("<", one(strLit("|"))))))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("LBraceToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("}"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("RBraceToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit(","))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("CommaToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(lexReq(one(part("isOperatorCharacter", one(lexReq(one(part("c", nil))))))))), one(part("then", one(block(nil, cons(defDec("startIndex", nil, nil, lexReq(one(part("index", nil)))), cons(varDec("op", nil, nil, one(lexReq(one(part("c", nil))))), cons(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))), cons(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(lexReq(one(part("isOperatorCharacter", one(lexReq(one(part("c", nil))))))), one(part("&&", one(dotReq(lexReq(one(part("index", nil))), one(part("<=", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("op", nil))), dotReq(lexReq(one(part("op", nil))), one(part("++", one(lexReq(one(part("c", nil)))))))), cons(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))), one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1))))))))))))))), cons(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("-", one(numLit(1)))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("op", nil))), one(part("==", one(strLit(":="))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("AssignToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("op", nil))), one(part("==", one(strLit("="))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("EqualsToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("op", nil))), one(part("==", one(strLit("->"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("ArrowToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("op", nil))), one(part("==", one(strLit("."))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("DotToken", one(lexReq(one(part("location", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("op", nil))), one(part("==", one(strLit(":"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("SymbolToken", cons(lexReq(one(part("location", nil))), one(strLit("COLON")))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("op", nil))), one(part("==", one(strLit("//"))))))), one(part("then", one(block(nil, cons(varDec("cp", nil, nil, one(dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil))))), cons(varDec("text", nil, nil, one(strLit(""))), cons(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("cp", nil))), one(part("!=", one(numLit(10))))), one(part("&&", one(dotReq(lexReq(one(part("cp", nil))), one(part("!=", one(numLit(13))))))))), one(part("&&", one(dotReq(lexReq(one(part("index", nil))), one(part("<=", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("text", nil))), dotReq(lexReq(one(part("text", nil))), one(part("++", one(lexReq(one(part("c", nil)))))))), cons(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))), cons(assn(lexReq(one(part("cp", nil))), dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil)))), one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))))))))))))), one(returnStmt(lexReq(one(part("CommentToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("text", nil)))))))))))))))))))), one(returnStmt(lexReq(one(part("OperatorToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("op", nil)))))))))))))))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil))), one(part("==", one(numLit(13))))))), one(part("then", one(block(nil, cons(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))), one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil))), one(part("==", one(numLit(10))))), one(part("||", one(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil))), one(part("==", one(numLit(8232))))))))))), one(part("then", one(block(nil, cons(assn(lexReq(one(part("line", nil))), dotReq(lexReq(one(part("line", nil))), one(part("+", one(numLit(1)))))), cons(assn(lexReq(one(part("lineStart", nil))), dotReq(lexReq(one(part("index", nil))), one(part("-", one(numLit(1)))))), one(returnStmt(lexReq(one(part("NewlineToken", one(lexReq(one(part("location", nil))))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil))), one(part("==", one(numLit(34))))))), one(part("then", one(block(nil, cons(varDec("value", nil, nil, one(strLit(""))), cons(varDec("escaped", nil, nil, one(lexReq(one(part("false", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil))))))), one(part("firstCodepoint", nil))), one(part("!=", one(numLit(34))))), one(part("||", one(lexReq(one(part("escaped", nil))))))))))), one(part("do", one(block(nil, cons(varDec("escapeNext", nil, nil, one(lexReq(one(part("false", nil))))), cons(defDec("cp", nil, nil, dotReq(dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil))))))), one(part("firstCodepoint", nil)))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("cp", nil))), one(part("==", one(numLit(92))))), one(part("&&", one(dotReq(lexReq(one(part("escaped", nil))), one(part("==", one(lexReq(one(part("false", nil))))))))))))), cons(part("then", one(block(nil, one(assn(lexReq(one(part("escapeNext", nil))), lexReq(one(part("true", nil)))))))), cons(part("elseif", one(block(nil, one(dotReq(lexReq(one(part("escaped", nil))), one(part("&&", one(dotReq(lexReq(one(part("cp", nil))), one(part("==", one(numLit(110))))))))))))), cons(part("then", one(block(nil, one(assn(lexReq(one(part("value", nil))), dotReq(lexReq(one(part("value", nil))), one(part("++", one(strLit("\n")))))))))), cons(part("elseif", one(block(nil, one(dotReq(lexReq(one(part("escaped", nil))), one(part("&&", one(dotReq(lexReq(one(part("cp", nil))), one(part("==", one(numLit(114))))))))))))), cons(part("then", one(block(nil, one(assn(lexReq(one(part("value", nil))), dotReq(lexReq(one(part("value", nil))), one(part("++", one(strLit("\r")))))))))), one(part("else", one(block(nil, one(assn(lexReq(one(part("value", nil))), dotReq(lexReq(one(part("value", nil))), one(part("++", one(dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))))))))))))))))))), cons(assn(lexReq(one(part("escaped", nil))), lexReq(one(part("escapeNext", nil)))), one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1))))))))))))))))), cons(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))), one(returnStmt(lexReq(one(part("StringToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("value", nil)))))))))))))))))))), cons(lexReq(cons(part("if", one(lexReq(one(part("isDigit", one(lexReq(one(part("c", nil))))))))), one(part("then", one(block(nil, cons(defDec("startIndex", nil, nil, dotReq(lexReq(one(part("index", nil))), one(part("-", one(numLit(1)))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("index", nil))), one(part(">=", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("NumberToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("c", nil)))))))))))))))), cons(varDec("value", nil, nil, one(strLit(""))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(lexReq(one(part("isDigit", one(lexReq(one(part("c", nil))))))), one(part("&&", one(dotReq(lexReq(one(part("index", nil))), one(part("<=", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("value", nil))), dotReq(lexReq(one(part("value", nil))), one(part("++", one(lexReq(one(part("c", nil)))))))), cons(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))), one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("index", nil))), one(part(">", one(dotReq(lexReq(one(part("startIndex", nil))), one(part("+", one(numLit(1))))))))))), one(part("then", one(block(nil, one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("-", one(numLit(1))))))))))))), one(returnStmt(lexReq(one(part("NumberToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("value", nil))))))))))))))))))))), cons(lexReq(cons(part("if", one(lexReq(one(part("isIdentifierStart", one(lexReq(one(part("c", nil))))))))), one(part("then", one(block(nil, cons(defDec("startIndex", nil, nil, dotReq(lexReq(one(part("index", nil))), one(part("-", one(numLit(1)))))), cons(varDec("value", nil, nil, one(lexReq(one(part("c", nil))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("index", nil))), one(part(">", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("IdentifierToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("value", nil)))))))))))))))), cons(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("isIdentifierStart", one(lexReq(one(part("c", nil))))))), one(part("||", one(lexReq(one(part("isDigit", one(lexReq(one(part("c", nil))))))))))), one(part("||", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("'"))))))))), one(part("&&", one(dotReq(lexReq(one(part("index", nil))), one(part("<=", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("value", nil))), dotReq(lexReq(one(part("value", nil))), one(part("++", one(lexReq(one(part("c", nil)))))))), cons(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))), one(lexReq(cons(part("if", one(dotReq(lexReq(one(part("index", nil))), one(part("<=", one(dotReq(lexReq(one(part("source", nil))), one(part("size", nil))))))))), one(part("then", one(block(nil, one(assn(lexReq(one(part("c", nil))), dotReq(lexReq(one(part("source", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))))))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("var"))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("def"))))))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("method"))))))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("object"))))))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("is"))))))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("return"))))))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("class"))))))))), one(part("||", one(dotReq(lexReq(one(part("value", nil))), one(part("==", one(strLit("type"))))))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("KeywordToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("value", nil)))))))))))))))), one(returnStmt(lexReq(one(part("IdentifierToken", cons(lexReq(one(part("location", nil))), one(lexReq(one(part("value", nil)))))))))))))))))))))), one(lexReq(one(part("print", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Unknown character: "), one(part("++", one(dotReq(lexReq(one(part("c", nil))), one(part("asString", nil))))))), one(part("++", one(strLit("("))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("c", nil))), one(part("firstCodepoint", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(") at index "))))), one(part("++", one(dotReq(lexReq(one(part("index", nil))), one(part("asString", nil)))))))))))))))))))))))))))))), cons(methDec(one(part("current", nil)), nil, nil, one(lexReq(one(part("currentToken", nil))))), cons(methDec(one(part("advance", nil)), nil, nil, one(assn(lexReq(one(part("currentToken", nil))), lexReq(one(part("nextToken", nil)))))), cons(methDec(one(part("expectToken", one(identifierDeclaration("nature", nil)))), nil, nil, one(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))), one(part("!=", one(lexReq(one(part("nature", nil))))))))), one(part("then", one(block(nil, cons(lexReq(one(part("print", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Expected "), one(part("++", one(lexReq(one(part("nature", nil))))))), one(part("++", one(strLit(" but got "))))), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Expected "), one(part("++", one(lexReq(one(part("nature", nil))))))), one(part("++", one(strLit(" but got "))))), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))))))))))))), cons(methDec(one(part("expectSymbol", one(identifierDeclaration("nature", nil)))), nil, nil, one(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))), one(part("!=", one(lexReq(one(part("nature", nil))))))))), one(part("then", one(block(nil, cons(lexReq(one(part("print", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Expected "), one(part("++", one(lexReq(one(part("nature", nil))))))), one(part("++", one(strLit(" but got "))))), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Expected "), one(part("++", one(lexReq(one(part("nature", nil))))))), one(part("++", one(strLit(" but got "))))), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))))))))))))), one(methDec(one(part("expectKeyword", one(identifierDeclaration("val", nil)))), nil, nil, cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))), one(part("!=", one(strLit("KEYWORD"))))))), one(part("then", one(block(nil, cons(lexReq(one(part("print", one(dotReq(dotReq(dotReq(strLit("Expected KEYWORD but got "), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(dotReq(dotReq(strLit("Expected KEYWORD but got "), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("nature", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))))))))))), one(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("value", nil))), one(part("!=", one(lexReq(one(part("val", nil))))))))), one(part("then", one(block(nil, cons(lexReq(one(part("print", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Expected "), one(part("++", one(lexReq(one(part("val", nil))))))), one(part("++", one(strLit(" but got "))))), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("value", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("Expected "), one(part("++", one(lexReq(one(part("val", nil))))))), one(part("++", one(strLit(" but got "))))), one(part("++", one(dotReq(lexReq(one(part("currentToken", nil))), one(part("value", nil))))))), one(part("++", one(strLit(" at "))))), one(part("++", one(dotReq(dotReq(lexReq(one(part("currentToken", nil))), one(part("position", nil))), one(part("asString", nil))))))))))))))))))))))))))))))))))))), cons(methDec(one(part("digitToNumber", one(identifierDeclaration("c", nil)))), nil, nil, cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("1"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(1))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("2"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(2))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("3"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(3))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("4"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(4))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("5"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(5))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("6"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(6))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("7"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(7))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("8"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(8))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("9"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(9))))))))), cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("c", nil))), one(part("==", one(strLit("0"))))))), one(part("then", one(block(nil, one(returnStmt(numLit(0))))))))), cons(lexReq(one(part("print", one(dotReq(strLit("Unexpected digit: "), one(part("++", one(dotReq(lexReq(one(part("c", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(strLit("Unexpected digit: "), one(part("++", one(dotReq(lexReq(one(part("c", nil))), one(part("asString", nil)))))))))))))))))))))))), cons(methDec(one(part("escapeString", one(identifierDeclaration("value", nil)))), nil, nil, one(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("value", nil))), cons(part("replace", one(strLit("\\"))), one(part("with", one(strLit("\\\\")))))), cons(part("replace", one(strLit("\""))), one(part("with", one(strLit("\\\"")))))), cons(part("replace", one(strLit("\n"))), one(part("with", one(strLit("\\n")))))), cons(part("replace", one(strLit("\r"))), one(part("with", one(strLit("\\r")))))))), cons(strLit("------- Methods from here until the end marker are duplicated in scope in Java"), cons(methDec(one(part("cons", cons(identifierDeclaration("hd", nil), one(identifierDeclaration("tl", nil))))), nil, nil, one(objCons(cons(defDec("head", nil, one("public"), lexReq(one(part("hd", nil)))), cons(defDec("tail", nil, one("public"), lexReq(one(part("tl", nil)))), cons(defDec("end", nil, one("public"), lexReq(one(part("false", nil)))), cons(methDec(one(part("asString", nil)), nil, nil, cons(lexReq(cons(part("if", one(dotReq(lexReq(one(part("tail", nil))), one(part("end", nil))))), one(part("then", one(block(nil, one(returnStmt(dotReq(dotReq(strLit("one("), one(part("++", one(dotReq(lexReq(one(part("head", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(")"))))))))))))), one(returnStmt(dotReq(dotReq(dotReq(dotReq(strLit("cons("), one(part("++", one(dotReq(lexReq(one(part("head", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(dotReq(lexReq(one(part("tail", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(")"))))))))), cons(methDec(one(part("reversed", one(identifierDeclaration("next", nil)))), nil, nil, cons(defDec("c", nil, nil, lexReq(one(part("cons", cons(lexReq(one(part("head", nil))), one(lexReq(one(part("next", nil))))))))), one(lexReq(cons(part("if", one(dotReq(lexReq(one(part("tail", nil))), one(part("end", nil))))), cons(part("then", one(block(nil, one(lexReq(one(part("c", nil))))))), one(part("else", one(block(nil, one(dotReq(lexReq(one(part("tail", nil))), one(part("reversed", one(lexReq(one(part("c", nil)))))))))))))))))), cons(methDec(one(part("stringHelper", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("cons("), one(part("++", one(dotReq(lexReq(one(part("head", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(dotReq(lexReq(one(part("tail", nil))), one(part("stringHelper", nil))))))), one(part("++", one(strLit(")"))))))), one(methDec(one(part("map", one(identifierDeclaration("f", nil)))), nil, nil, one(lexReq(one(part("cons", cons(dotReq(lexReq(one(part("f", nil))), one(part("apply", one(lexReq(one(part("head", nil))))))), one(dotReq(lexReq(one(part("tail", nil))), one(part("map", one(lexReq(one(part("f", nil)))))))))))))))))))))))), cons(methDec(one(part("nil", nil)), nil, nil, one(objCons(cons(defDec("end", nil, one("public"), lexReq(one(part("true", nil)))), cons(methDec(one(part("asString", nil)), nil, nil, one(strLit("no"))), cons(methDec(one(part("reversed", one(identifierDeclaration("next", nil)))), nil, nil, one(lexReq(one(part("next", nil))))), cons(methDec(one(part("stringHelper", nil)), nil, nil, one(strLit("nil"))), one(methDec(one(part("map", one(identifierDeclaration("f", nil)))), nil, nil, one(lexReq(one(part("nil", nil))))))))))))), cons(methDec(one(part("numberNode", one(identifierDeclaration("val", nil)))), nil, nil, one(objCons(cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(strLit("numLit("), one(part("++", one(dotReq(lexReq(one(part("value", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(")")))))))))))), cons(methDec(one(part("stringNode", one(identifierDeclaration("val", nil)))), nil, nil, one(objCons(cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(strLit("strLit(\""), one(part("++", one(lexReq(one(part("escapeString", one(lexReq(one(part("value", nil))))))))))), one(part("++", one(strLit("\")")))))))))))), cons(methDec(one(part("block", cons(identifierDeclaration("params", nil), one(identifierDeclaration("stmts", nil))))), nil, nil, one(objCons(cons(defDec("parameters", nil, one("public"), lexReq(one(part("params", nil)))), cons(defDec("statements", nil, one("public"), lexReq(one(part("stmts", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("block("), one(part("++", one(lexReq(one(part("parameters", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("statements", nil))))))), one(part("++", one(strLit(")"))))))))))))), cons(methDec(one(part("defDecl", cons(identifierDeclaration("id", nil), cons(identifierDeclaration("dtype", nil), cons(identifierDeclaration("anns", nil), one(identifierDeclaration("val", nil))))))), nil, nil, one(objCons(cons(defDec("name", nil, one("public"), lexReq(one(part("id", nil)))), cons(defDec("decType", nil, one("public"), lexReq(one(part("dtype", nil)))), cons(defDec("annotations", nil, one("public"), lexReq(one(part("anns", nil)))), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("defDec(\""), one(part("++", one(lexReq(one(part("name", nil))))))), one(part("++", one(strLit("\", "))))), one(part("++", one(lexReq(one(part("decType", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(dotReq(lexReq(one(part("anns", nil))), one(part("map", one(block(one(lexReq(one(part("x", nil)))), one(dotReq(dotReq(strLit("\""), one(part("++", one(lexReq(one(part("x", nil))))))), one(part("++", one(strLit("\""))))))))))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")"))))))))))))))), cons(methDec(one(part("varDecl", cons(identifierDeclaration("id", nil), cons(identifierDeclaration("dtype", nil), cons(identifierDeclaration("anns", nil), one(identifierDeclaration("val", nil))))))), nil, nil, one(objCons(cons(defDec("name", nil, one("public"), lexReq(one(part("id", nil)))), cons(defDec("decType", nil, one("public"), lexReq(one(part("dtype", nil)))), cons(defDec("annotations", nil, one("public"), lexReq(one(part("anns", nil)))), cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("varDec(\""), one(part("++", one(lexReq(one(part("name", nil))))))), one(part("++", one(strLit("\", "))))), one(part("++", one(lexReq(one(part("dtype", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(dotReq(lexReq(one(part("anns", nil))), one(part("map", one(block(one(lexReq(one(part("x", nil)))), one(dotReq(dotReq(strLit("\""), one(part("++", one(lexReq(one(part("x", nil))))))), one(part("++", one(strLit("\""))))))))))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")"))))))))))))))), cons(methDec(one(part("lexicalRequest", one(identifierDeclaration("requestParts", nil)))), nil, nil, one(objCons(cons(defDec("parts", nil, one("public"), lexReq(one(part("requestParts", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(strLit("lexReq("), one(part("++", one(lexReq(one(part("parts", nil))))))), one(part("++", one(strLit(")")))))))))))), cons(methDec(one(part("explicitRequest", cons(identifierDeclaration("pos", nil), cons(identifierDeclaration("rec", nil), one(identifierDeclaration("requestParts", nil)))))), nil, nil, one(objCons(cons(defDec("receiver", nil, one("public"), lexReq(one(part("rec", nil)))), cons(defDec("parts", nil, one("public"), lexReq(one(part("requestParts", nil)))), cons(defDec("position", nil, one("public"), lexReq(one(part("pos", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("dotReq("), one(part("++", one(dotReq(lexReq(one(part("receiver", nil))), one(part("asString", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("parts", nil))))))), one(part("++", one(strLit(")")))))))))))))), cons(methDec(one(part("requestPart", cons(identifierDeclaration("partName", nil), one(identifierDeclaration("args", nil))))), nil, nil, one(objCons(cons(defDec("name", nil, one("public"), lexReq(one(part("partName", nil)))), cons(defDec("arguments", nil, one("public"), lexReq(one(part("args", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("part(\""), one(part("++", one(lexReq(one(part("name", nil))))))), one(part("++", one(strLit("\", "))))), one(part("++", one(lexReq(one(part("args", nil))))))), one(part("++", one(strLit(")"))))))))))))), cons(methDec(one(part("part", cons(identifierDeclaration("partName", nil), one(identifierDeclaration("args", nil))))), nil, nil, one(objCons(cons(defDec("name", nil, one("public"), lexReq(one(part("partName", nil)))), cons(defDec("parameters", nil, one("public"), lexReq(one(part("args", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("part(\""), one(part("++", one(lexReq(one(part("name", nil))))))), one(part("++", one(strLit("\", "))))), one(part("++", one(lexReq(one(part("parameters", nil))))))), one(part("++", one(strLit(")"))))))))))))), cons(methDec(one(part("methodDecl", cons(identifierDeclaration("declarationParts", nil), cons(identifierDeclaration("retType", nil), cons(identifierDeclaration("anns", nil), one(identifierDeclaration("bd", nil))))))), nil, nil, one(objCons(cons(defDec("parts", nil, one("public"), lexReq(one(part("declarationParts", nil)))), cons(defDec("returnType", nil, one("public"), lexReq(one(part("retType", nil)))), cons(defDec("annotations", nil, one("public"), lexReq(one(part("anns", nil)))), cons(defDec("body", nil, one("public"), lexReq(one(part("bd", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(dotReq(strLit("methDec("), one(part("++", one(lexReq(one(part("parts", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("returnType", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("annotations", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("body", nil))))))), one(part("++", one(strLit(")"))))))))))))))), cons(methDec(one(part("declarationPart", cons(identifierDeclaration("id", nil), one(identifierDeclaration("params", nil))))), nil, nil, one(objCons(cons(defDec("name", nil, one("public"), lexReq(one(part("id", nil)))), cons(defDec("parameters", nil, one("public"), lexReq(one(part("params", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("part(\""), one(part("++", one(lexReq(one(part("name", nil))))))), one(part("++", one(strLit("\", "))))), one(part("++", one(lexReq(one(part("parameters", nil))))))), one(part("++", one(strLit(")"))))))))))))), cons(methDec(one(part("objectConstructor", one(identifierDeclaration("bd", nil)))), nil, nil, one(objCons(cons(defDec("body", nil, one("public"), lexReq(one(part("bd", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(strLit("objCons("), one(part("++", one(lexReq(one(part("body", nil))))))), one(part("++", one(strLit(")")))))))))))), cons(methDec(one(part("assign", cons(identifierDeclaration("lhs", nil), one(identifierDeclaration("rhs", nil))))), nil, nil, one(objCons(cons(defDec("left", nil, one("public"), lexReq(one(part("lhs", nil)))), cons(defDec("right", nil, one("public"), lexReq(one(part("rhs", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("assn("), one(part("++", one(lexReq(one(part("left", nil))))))), one(part("++", one(strLit(", "))))), one(part("++", one(lexReq(one(part("right", nil))))))), one(part("++", one(strLit(")"))))))))))))), cons(methDec(one(part("returnStmt", one(identifierDeclaration("val", nil)))), nil, nil, one(objCons(cons(defDec("value", nil, one("public"), lexReq(one(part("val", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(strLit("returnStmt("), one(part("++", one(lexReq(one(part("value", nil))))))), one(part("++", one(strLit(")")))))))))))), cons(methDec(one(part("identifierDeclaration", cons(identifierDeclaration("id", nil), one(identifierDeclaration("dtype", nil))))), nil, nil, one(objCons(cons(defDec("name", nil, one("public"), lexReq(one(part("id", nil)))), cons(defDec("decType", nil, one("public"), lexReq(one(part("dtype", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(dotReq(dotReq(strLit("identifierDeclaration(\""), one(part("++", one(lexReq(one(part("name", nil))))))), one(part("++", one(strLit("\", "))))), one(part("++", one(lexReq(one(part("dtype", nil))))))), one(part("++", one(strLit(")"))))))))))))), cons(methDec(one(part("comment", one(identifierDeclaration("text", nil)))), nil, nil, one(objCons(cons(defDec("value", nil, one("public"), lexReq(one(part("text", nil)))), one(methDec(one(part("asString", nil)), nil, nil, one(dotReq(dotReq(strLit("comment(\""), one(part("++", one(lexReq(one(part("escapeString", one(lexReq(one(part("text", nil))))))))))), one(part("++", one(strLit("\")")))))))))))), cons(strLit("------- End marker; methods back to the start marker are duplicated in scope in Java"), cons(methDec(one(part("parseNumber", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(defDec("token", nil, nil, dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("s", nil, nil, dotReq(lexReq(one(part("token", nil))), one(part("value", nil)))), cons(varDec("val", nil, nil, one(numLit(0))), cons(varDec("index", nil, nil, one(numLit(1))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(lexReq(one(part("index", nil))), one(part("<=", one(dotReq(lexReq(one(part("s", nil))), one(part("size", nil))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("val", nil))), dotReq(dotReq(lexReq(one(part("val", nil))), one(part("*", one(numLit(10))))), one(part("+", one(lexReq(one(part("digitToNumber", one(dotReq(lexReq(one(part("s", nil))), one(part("at", one(lexReq(one(part("index", nil)))))))))))))))), one(assn(lexReq(one(part("index", nil))), dotReq(lexReq(one(part("index", nil))), one(part("+", one(numLit(1)))))))))))))), one(lexReq(one(part("numberNode", one(lexReq(one(part("val", nil))))))))))))))), cons(methDec(one(part("parseString", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(defDec("token", nil, nil, dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(one(part("stringNode", one(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))))))))))), cons(methDec(one(part("parseLexicalRequestNoBlock", cons(identifierDeclaration("lxr", nil), one(identifierDeclaration("id", nil))))), nil, nil, cons(defDec("parts", nil, nil, lexReq(one(part("parseRequestParts", cons(lexReq(one(part("lxr", nil))), one(lexReq(one(part("false", nil))))))))), one(lexReq(one(part("lexicalRequest", one(lexReq(one(part("parts", nil)))))))))), cons(methDec(one(part("parselexicalRequest", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(defDec("parts", nil, nil, lexReq(one(part("parseRequestParts", cons(lexReq(one(part("lxr", nil))), one(lexReq(one(part("true", nil))))))))), one(lexReq(one(part("lexicalRequest", one(lexReq(one(part("parts", nil)))))))))), cons(methDec(one(part("parseRequestParts", cons(identifierDeclaration("lxr", nil), one(identifierDeclaration("allowBlock", nil))))), nil, nil, cons(varDec("parts", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("IDENTIFIER"))))))))), one(part("do", one(block(nil, cons(varDec("id", nil, nil, one(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("LPAREN"))))))), cons(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("args", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("RPAREN"))))), one(part("&&", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("EOF"))))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("args", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("args", nil))))))))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COMMA"))))))), one(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil)))))))))))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("part", nil, nil, lexReq(one(part("requestPart", cons(lexReq(one(part("id", nil))), one(dotReq(lexReq(one(part("args", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil)))))))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(lexReq(one(part("allowBlock", nil))), one(part("&&", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("LBRACE"))))))))))))), cons(part("then", one(block(nil, cons(defDec("blk", nil, nil, lexReq(one(part("parseBlock", one(lexReq(one(part("lxr", nil)))))))), cons(defDec("part", nil, nil, lexReq(one(part("requestPart", cons(lexReq(one(part("id", nil))), one(lexReq(one(part("cons", cons(lexReq(one(part("blk", nil))), one(lexReq(one(part("nil", nil)))))))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil))))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("NUMBER"))))))))), cons(part("then", one(block(nil, cons(defDec("num", nil, nil, lexReq(one(part("parseNumber", one(lexReq(one(part("lxr", nil)))))))), cons(defDec("part", nil, nil, lexReq(one(part("requestPart", cons(lexReq(one(part("id", nil))), one(lexReq(one(part("cons", cons(lexReq(one(part("num", nil))), one(lexReq(one(part("nil", nil)))))))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil))))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("STRING"))))))))), cons(part("then", one(block(nil, cons(defDec("str", nil, nil, lexReq(one(part("parseString", one(lexReq(one(part("lxr", nil)))))))), cons(defDec("part", nil, nil, lexReq(one(part("requestPart", cons(lexReq(one(part("id", nil))), one(lexReq(one(part("cons", cons(lexReq(one(part("str", nil))), one(lexReq(one(part("nil", nil)))))))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil))))))))))))))), one(part("else", one(block(nil, cons(defDec("part", nil, nil, lexReq(one(part("requestPart", cons(lexReq(one(part("id", nil))), one(lexReq(one(part("nil", nil))))))))), cons(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil))))))))), one(returnStmt(dotReq(lexReq(one(part("parts", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))))))))))))))))))))))))), one(dotReq(lexReq(one(part("parts", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))), cons(methDec(one(part("parseExplicitRequestNoBlock", cons(identifierDeclaration("receiver", nil), one(identifierDeclaration("lxr", nil))))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("pos", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("asString", nil)))), cons(defDec("parts", nil, nil, lexReq(one(part("parseRequestParts", cons(lexReq(one(part("lxr", nil))), one(lexReq(one(part("false", nil))))))))), one(lexReq(one(part("explicitRequest", cons(lexReq(one(part("pos", nil))), cons(lexReq(one(part("receiver", nil))), one(lexReq(one(part("parts", nil)))))))))))))), cons(methDec(one(part("parseExplicitRequest", cons(identifierDeclaration("receiver", nil), one(identifierDeclaration("lxr", nil))))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("pos", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("asString", nil)))), cons(defDec("parts", nil, nil, lexReq(one(part("parseRequestParts", cons(lexReq(one(part("lxr", nil))), one(lexReq(one(part("true", nil))))))))), one(lexReq(one(part("explicitRequest", cons(lexReq(one(part("pos", nil))), cons(lexReq(one(part("receiver", nil))), one(lexReq(one(part("parts", nil)))))))))))))), cons(methDec(one(part("parseTypeExpression", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(defDec("token", nil, nil, dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("IDENTIFIER"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseLexicalRequestNoBlock", cons(lexReq(one(part("lxr", nil))), one(dotReq(lexReq(one(part("token", nil))), one(part("value", nil)))))))))))))))), cons(lexReq(one(part("print", one(dotReq(strLit("Unexpected token: "), one(part("++", one(dotReq(lexReq(one(part("token", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(strLit("Unexpected token: "), one(part("++", one(dotReq(lexReq(one(part("token", nil))), one(part("asString", nil)))))))))))))))), cons(methDec(one(part("parseExpressionNoOpNoDot", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(defDec("token", nil, nil, dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("NUMBER"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseNumber", one(lexReq(one(part("lxr", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("STRING"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseString", one(lexReq(one(part("lxr", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("LPAREN"))))))), one(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("expr", nil, nil, lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil)))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(returnStmt(lexReq(one(part("expr", nil)))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("LBRACE"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseBlock", one(lexReq(one(part("lxr", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("IDENTIFIER"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parselexicalRequest", one(lexReq(one(part("lxr", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))), one(part("then", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("object"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseObject", one(lexReq(one(part("lxr", nil)))))))))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("OPERATOR"))))))), one(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("pos", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("asString", nil)))), cons(defDec("expr", nil, nil, lexReq(one(part("parseExpressionNoOp", one(lexReq(one(part("lxr", nil)))))))), one(returnStmt(lexReq(one(part("explicitRequest", cons(lexReq(one(part("pos", nil))), cons(lexReq(one(part("expr", nil))), one(lexReq(one(part("cons", cons(lexReq(one(part("requestPart", cons(dotReq(strLit("prefix"), one(part("++", one(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))))))), one(lexReq(one(part("nil", nil)))))))), one(lexReq(one(part("nil", nil))))))))))))))))))))))))), cons(lexReq(one(part("print", one(dotReq(strLit("Unexpected token: "), one(part("++", one(dotReq(lexReq(one(part("token", nil))), one(part("asString", nil))))))))))), one(dotReq(lexReq(one(part("Exception", nil))), one(part("raise", one(dotReq(strLit("Unexpected token: "), one(part("++", one(dotReq(lexReq(one(part("token", nil))), one(part("asString", nil)))))))))))))))))))))), cons(methDec(one(part("parseExpressionNoOp", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(varDec("left", nil, nil, one(lexReq(one(part("parseExpressionNoOpNoDot", one(lexReq(one(part("lxr", nil))))))))), cons(varDec("token", nil, nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("DOT"))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("left", nil))), lexReq(one(part("parseExplicitRequest", cons(lexReq(one(part("left", nil))), one(lexReq(one(part("lxr", nil))))))))), one(assn(lexReq(one(part("token", nil))), dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))))))))))), one(returnStmt(lexReq(one(part("left", nil))))))))), cons(methDec(one(part("parseExpression", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(varDec("left", nil, nil, one(lexReq(one(part("parseExpressionNoOp", one(lexReq(one(part("lxr", nil))))))))), cons(varDec("token", nil, nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("OPERATOR"))))))))), one(part("do", one(block(nil, cons(defDec("pos", nil, nil, dotReq(lexReq(one(part("token", nil))), one(part("asString", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("right", nil, nil, lexReq(one(part("parseExpressionNoOp", one(lexReq(one(part("lxr", nil)))))))), cons(defDec("args", nil, nil, lexReq(one(part("cons", cons(lexReq(one(part("right", nil))), one(lexReq(one(part("nil", nil))))))))), cons(defDec("part", nil, nil, lexReq(one(part("requestPart", cons(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(lexReq(one(part("args", nil))))))))), cons(defDec("parts", nil, nil, lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("nil", nil))))))))), cons(defDec("req", nil, nil, lexReq(one(part("explicitRequest", cons(lexReq(one(part("pos", nil))), cons(lexReq(one(part("left", nil))), one(dotReq(lexReq(one(part("parts", nil))), one(part("reversed", one(lexReq(one(part("nil", nil)))))))))))))), cons(assn(lexReq(one(part("left", nil))), lexReq(one(part("req", nil)))), one(assn(lexReq(one(part("token", nil))), dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))))))))))))))))))), one(returnStmt(lexReq(one(part("left", nil))))))))), cons(methDec(one(part("parseReturnStatement", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("val", nil, nil, lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil)))))))), one(lexReq(one(part("returnStmt", one(lexReq(one(part("val", nil))))))))))), cons(methDec(one(part("parseStatement", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(defDec("token", nil, nil, dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))), cons(part("then", one(block(nil, cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("return"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseReturnStatement", one(lexReq(one(part("lxr", nil))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("var"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseVarDeclaration", one(lexReq(one(part("lxr", nil))))))))))))))), one(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("def"))))))), one(part("then", one(block(nil, one(returnStmt(lexReq(one(part("parseDefDeclaration", one(lexReq(one(part("lxr", nil))))))))))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("COMMENT"))))))))), one(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(returnStmt(lexReq(one(part("comment", one(dotReq(lexReq(one(part("token", nil))), one(part("value", nil)))))))))))))))))), cons(varDec("exp", nil, nil, one(lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("ASSIGN"))))))), one(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("val", nil, nil, lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("exp", nil))), lexReq(one(part("assign", cons(lexReq(one(part("exp", nil))), one(lexReq(one(part("val", nil)))))))))))))))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("NEWLINE"))))))), one(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil)))))))))), one(lexReq(one(part("exp", nil)))))))))), cons(methDec(one(part("parseBlock", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(varDec("params", nil, nil, one(lexReq(one(part("nil", nil))))), cons(varDec("body", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("LBRACE"))))))), one(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("NEWLINE"))))))))), one(part("do", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil)))))))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("RBRACE"))))))))), one(part("do", one(block(nil, cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("ARROW"))))))), cons(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(assn(lexReq(one(part("params", nil))), lexReq(one(part("body", nil)))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("nil", nil)))))))))), one(part("else", one(block(nil, one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseStatement", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("body", nil))))))))))))))))), one(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("NEWLINE"))))))))), one(part("do", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil)))))))))))))))))), one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))))))))))))), one(lexReq(one(part("block", cons(lexReq(one(part("params", nil))), one(dotReq(lexReq(one(part("body", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))))))))), cons(methDec(one(part("parseAnnotations", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(varDec("anns", nil, nil, one(lexReq(one(part("nil", nil))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("IDENTIFIER"))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("anns", nil))), lexReq(one(part("cons", cons(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))), one(lexReq(one(part("anns", nil))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COMMA"))))))), one(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))))))))))))))))))), one(dotReq(lexReq(one(part("anns", nil))), one(part("reversed", one(lexReq(one(part("nil", nil)))))))))))), cons(methDec(one(part("parseDefDeclaration", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("name", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("dtype", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COLON"))))))), one(part("then", one(block(nil, cons(comment(" Type annotation"), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(assn(lexReq(one(part("dtype", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("nil", nil)))))))))))))))))), cons(varDec("anns", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))), one(part("then", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))), one(part("==", one(strLit("is"))))))), one(part("then", one(block(nil, one(assn(lexReq(one(part("anns", nil))), lexReq(one(part("parseAnnotations", one(lexReq(one(part("lxr", nil)))))))))))))))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("val", nil, nil, lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil)))))))), one(lexReq(one(part("defDecl", cons(lexReq(one(part("name", nil))), cons(lexReq(one(part("dtype", nil))), cons(lexReq(one(part("anns", nil))), one(lexReq(one(part("val", nil))))))))))))))))))))), cons(methDec(one(part("parseVarDeclaration", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("name", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("dtype", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COLON"))))))), one(part("then", one(block(nil, cons(comment(" Type annotation"), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(assn(lexReq(one(part("dtype", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("nil", nil)))))))))))))))))), cons(varDec("anns", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))), one(part("then", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))), one(part("==", one(strLit("is"))))))), one(part("then", one(block(nil, one(assn(lexReq(one(part("anns", nil))), lexReq(one(part("parseAnnotations", one(lexReq(one(part("lxr", nil)))))))))))))))))))))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("ASSIGN"))))))), cons(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("val", nil, nil, lexReq(one(part("parseExpression", one(lexReq(one(part("lxr", nil)))))))), one(lexReq(one(part("varDecl", cons(lexReq(one(part("name", nil))), cons(lexReq(one(part("dtype", nil))), cons(lexReq(one(part("anns", nil))), one(lexReq(one(part("cons", cons(lexReq(one(part("val", nil))), one(lexReq(one(part("nil", nil))))))))))))))))))))), one(part("else", one(block(nil, one(lexReq(one(part("varDecl", cons(lexReq(one(part("name", nil))), cons(lexReq(one(part("dtype", nil))), cons(lexReq(one(part("anns", nil))), one(lexReq(one(part("nil", nil))))))))))))))))))))))))))), cons(methDec(one(part("parseMethodBody", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(varDec("body", nil, nil, one(lexReq(one(part("nil", nil))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("RBRACE"))))))))), one(part("do", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("NEWLINE"))))))), cons(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))))), cons(part("then", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))), one(part("==", one(strLit("var"))))))), cons(part("then", one(block(nil, cons(defDec("dec", nil, nil, lexReq(one(part("parseVarDeclaration", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("dec", nil))), one(lexReq(one(part("body", nil)))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))), one(part("==", one(strLit("def"))))))))), cons(part("then", one(block(nil, cons(defDec("dec", nil, nil, lexReq(one(part("parseDefDeclaration", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("dec", nil))), one(lexReq(one(part("body", nil)))))))))))))), one(part("else", one(block(nil, one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseStatement", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("body", nil))))))))))))))))))))))), one(part("else", one(block(nil, one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseStatement", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("body", nil)))))))))))))))))))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(dotReq(lexReq(one(part("body", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))))), cons(methDec(one(part("parseMethodDeclaration", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("parts", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("IDENTIFIER"))))))))), one(part("do", one(block(nil, cons(defDec("id", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("LPAREN"))))))), cons(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("args", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("RPAREN"))))), one(part("&&", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("EOF"))))))))))))), one(part("do", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("expectToken", one(strLit("IDENTIFIER"))))), cons(defDec("idToken", nil, nil, dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))), cons(varDec("dtype", nil, nil, one(lexReq(one(part("nil", nil))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COLON"))))))), one(part("then", one(block(nil, cons(comment(" Type annotation"), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(assn(lexReq(one(part("dtype", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseTypeExpression", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("nil", nil)))))))))))))))))), cons(assn(lexReq(one(part("args", nil))), lexReq(one(part("cons", cons(lexReq(one(part("identifierDeclaration", cons(dotReq(lexReq(one(part("idToken", nil))), one(part("value", nil))), one(lexReq(one(part("dtype", nil)))))))), one(lexReq(one(part("args", nil))))))))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COMMA"))))))), one(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))))))))))))))))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("part", nil, nil, lexReq(one(part("declarationPart", cons(lexReq(one(part("id", nil))), one(dotReq(lexReq(one(part("args", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil)))))))))))))))))), one(part("else", one(block(nil, cons(defDec("part", nil, nil, lexReq(one(part("declarationPart", cons(lexReq(one(part("id", nil))), one(lexReq(one(part("nil", nil))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil))))))))))))))))))))))))))), cons(varDec("dtype", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("ARROW"))))))), one(part("then", one(block(nil, cons(comment(" Type annotation"), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(assn(lexReq(one(part("dtype", nil))), lexReq(one(part("cons", cons(lexReq(one(part("parseTypeExpression", one(lexReq(one(part("lxr", nil))))))), one(lexReq(one(part("nil", nil)))))))))))))))))), cons(varDec("anns", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))), one(part("then", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))), one(part("==", one(strLit("is"))))))), one(part("then", one(block(nil, one(assn(lexReq(one(part("anns", nil))), lexReq(one(part("parseAnnotations", one(lexReq(one(part("lxr", nil)))))))))))))))))))))), cons(comment("lxr.advance"), cons(defDec("body", nil, nil, lexReq(one(part("parseMethodBody", one(lexReq(one(part("lxr", nil)))))))), one(lexReq(one(part("methodDecl", cons(dotReq(lexReq(one(part("parts", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))), cons(lexReq(one(part("dtype", nil))), cons(lexReq(one(part("anns", nil))), one(lexReq(one(part("body", nil))))))))))))))))))))), cons(methDec(one(part("parseClassDeclaration", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("parts", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("IDENTIFIER"))))))))), one(part("do", one(block(nil, cons(defDec("id", nil, nil, dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil)))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("LPAREN"))))))), cons(part("then", one(block(nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(varDec("args", nil, nil, one(lexReq(one(part("nil", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("RPAREN"))))), one(part("&&", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("!=", one(strLit("EOF"))))))))))))), one(part("do", one(block(nil, cons(assn(lexReq(one(part("args", nil))), lexReq(one(part("cons", cons(lexReq(one(part("identifierDeclaration", one(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("value", nil))))))), one(lexReq(one(part("args", nil))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(cons(part("if", one(dotReq(dotReq(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))), one(part("nature", nil))), one(part("==", one(strLit("COMMA"))))))), one(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))))))))))))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("part", nil, nil, lexReq(one(part("declarationPart", cons(lexReq(one(part("id", nil))), one(dotReq(lexReq(one(part("args", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil)))))))))))))))))), one(part("else", one(block(nil, cons(defDec("part", nil, nil, lexReq(one(part("declarationPart", cons(lexReq(one(part("id", nil))), one(lexReq(one(part("nil", nil))))))))), one(assn(lexReq(one(part("parts", nil))), lexReq(one(part("cons", cons(lexReq(one(part("part", nil))), one(lexReq(one(part("parts", nil))))))))))))))))))))))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("body", nil, nil, lexReq(one(part("parseObjectBody", one(lexReq(one(part("lxr", nil)))))))), cons(defDec("obj", nil, nil, lexReq(one(part("objectConstructor", one(lexReq(one(part("body", nil)))))))), one(lexReq(one(part("methodDecl", cons(dotReq(lexReq(one(part("parts", nil))), one(part("reversed", one(lexReq(one(part("nil", nil))))))), cons(lexReq(one(part("nil", nil))), cons(lexReq(one(part("nil", nil))), one(lexReq(one(part("cons", cons(lexReq(one(part("obj", nil))), one(lexReq(one(part("nil", nil))))))))))))))))))))))), cons(methDec(one(part("parseObjectBody", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(varDec("body", nil, nil, one(lexReq(one(part("nil", nil))))), cons(varDec("token", nil, nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil))))), cons(lexReq(cons(part("while", one(block(nil, one(dotReq(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("!=", one(strLit("EOF"))))), one(part("&&", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("!=", one(strLit("RBRACE"))))))))))))), one(part("do", one(block(nil, cons(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("NEWLINE"))))))), cons(part("then", one(block(nil, one(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("nature", nil))), one(part("==", one(strLit("KEYWORD"))))))))), cons(part("then", one(block(nil, one(lexReq(cons(part("if", one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("var"))))))), cons(part("then", one(block(nil, cons(defDec("dec", nil, nil, lexReq(one(part("parseVarDeclaration", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("dec", nil))), one(lexReq(one(part("body", nil)))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("def"))))))))), cons(part("then", one(block(nil, cons(defDec("dec", nil, nil, lexReq(one(part("parseDefDeclaration", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("dec", nil))), one(lexReq(one(part("body", nil)))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("method"))))))))), cons(part("then", one(block(nil, cons(defDec("dec", nil, nil, lexReq(one(part("parseMethodDeclaration", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("dec", nil))), one(lexReq(one(part("body", nil)))))))))))))), cons(part("elseif", one(block(nil, one(dotReq(dotReq(lexReq(one(part("token", nil))), one(part("value", nil))), one(part("==", one(strLit("class"))))))))), cons(part("then", one(block(nil, cons(defDec("dec", nil, nil, lexReq(one(part("parseClassDeclaration", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("dec", nil))), one(lexReq(one(part("body", nil)))))))))))))), one(part("else", one(block(nil, cons(defDec("stmt", nil, nil, lexReq(one(part("parseStatement", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("stmt", nil))), one(lexReq(one(part("body", nil)))))))))))))))))))))))))))), one(part("else", one(block(nil, cons(defDec("stmt", nil, nil, lexReq(one(part("parseStatement", one(lexReq(one(part("lxr", nil)))))))), one(assn(lexReq(one(part("body", nil))), lexReq(one(part("cons", cons(lexReq(one(part("stmt", nil))), one(lexReq(one(part("body", nil)))))))))))))))))))), one(assn(lexReq(one(part("token", nil))), dotReq(lexReq(one(part("lxr", nil))), one(part("current", nil)))))))))))), one(dotReq(lexReq(one(part("body", nil))), one(part("reversed", one(lexReq(one(part("nil", nil)))))))))))), cons(methDec(one(part("parseObject", one(identifierDeclaration("lxr", nil)))), nil, nil, cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), cons(defDec("body", nil, nil, lexReq(one(part("parseObjectBody", one(lexReq(one(part("lxr", nil)))))))), cons(dotReq(lexReq(one(part("lxr", nil))), one(part("advance", nil))), one(lexReq(one(part("objectConstructor", one(lexReq(one(part("body", nil))))))))))))), one(methDec(one(part("parse", one(identifierDeclaration("code", nil)))), nil, nil, cons(defDec("lxr", nil, nil, lexReq(one(part("lexer", one(lexReq(one(part("code", nil)))))))), cons(defDec("body", nil, nil, lexReq(one(part("parseObjectBody", one(lexReq(one(part("lxr", nil)))))))), one(lexReq(one(part("objectConstructor", one(lexReq(one(part("body", nil)))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

export default program